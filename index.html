<script>
    document.addEventListener('DOMContentLoaded', function() {
        var currentURL = window.location.href;
        var keywordIndex = currentURL.indexOf('?');

        if (keywordIndex !== -1) {
            var keyword = currentURL.substring(keywordIndex + 1);

            fetch('https://script.google.com/macros/s/AKfycbwJgR1iLkDU-Hly1MHRR4kfUFpkmm27kE9bxwxEMFg0_UpV_moIIhSjR1sWLcNXcIR9bg/exec?keyword=' + keyword)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        var originalLink = data.originalLink;
                        var isGoogleDriveLink = originalLink.includes("drive.google.com") || originalLink.includes("docs.google.com");
                        var referrer = document.referrer || '';
                        var isReferrerBlogspot = referrer.includes('https://apks2life.blogspot.com');

                        if (isGoogleDriveLink && !isReferrerBlogspot) {
                            window.location.href = originalLink;
                        } else {
                            window.location.href = originalLink;
                        }
                    } else {
                        console.error('Không tìm thấy link gốc.');
                    }
                })
                .catch(error => console.error('Error:', error));
        }
    });
</script>
